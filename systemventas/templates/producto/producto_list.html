{% extends 'base.html' %}
{% block content %}
<h1>Lista de Productos</h1>

<!-- FORMULARIO DE BÚSQUEDA RESPONSIVO -->
<form method="get" action="{% url 'producto:producto_list' %}" class="d-flex flex-column flex-sm-row mb-3">
    <input type="text" name="q" value="{{ request.GET.q }}" placeholder="Ingrese el nombre del producto..." 
           class="form-control mb-2 mb-sm-0"> 
    <button type="submit" class="btn btn-primary ms-sm-2">Buscar</button> 
</form>

<!-- BOTONES UNO AL LADO DEL OTRO -->
<div class="mt-3 d-flex gap-2 ">
    <a href="{% url 'producto:producto_create' %}" class="btn btn-success">
         + Agregar nuevo producto
    </a>
    <a href="{% url 'producto:stock_bajo_list' %}" class="btn btn-warning">
        Ajustar stock mínimo
    </a>
</div>


{% if producto %}
<!-- TABLA RESPONSIVA -->
<div class="table-responsive"> 
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>SKU</th>
                <th>Nombre</th>
                <th>Descripción</th>
                <th>Precio</th>
                <th>Stock</th>
                <th>Stock mínimo</th>
                <th>Imagen</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for p in producto %}
                <tr>
                    <td>{{ p.sku }}</td>
                    <td>{{ p.nombre }}</td>
                    <td>{{ p.descripcion }}</td>
                    <td>${{ p.precio }}</td>
                    <td>{{ p.stock }}</td>
                    <td>{{ p.stock_minimo }}</td>
                    <td>
                        {% if p.imagen %}
                            <img src="{{ p.imagen.url }}" alt="{{ p.nombre }}" width="50" height="50">
                        {% else %}
                            Sin imagen
                        {% endif %}
                    </td>
                    <td>
                        <!-- Botones apilables en móvil, en línea en escritorio -->
                        <div class="d-flex flex-column flex-md-row gap-1">
                            <a href="{% url 'producto:producto_detail' p.pk %}" class="btn btn-info mb-1 mb-md-0 me-md-1">Ver</a>
                            <a href="{% url 'producto:producto_update' p.pk %}" class="btn btn-primary mb-1 mb-md-0 me-md-1">Modificar</a>
                            <a href="{% url 'producto:producto_delete' p.pk %}" class="btn btn-danger">Eliminar</a>
                        </div>
                    </td>
                </tr>
            {% endfor %}  
        </tbody>
    </table>
</div> <!-- fin de table-responsive -->

{% else %}
    <p>No hay productos registrados.</p> 
{% endif %}


<!-- PAGINADOR -->
<div class="mt-3">
    {% include 'paginator.html' %}
</div>

{% endblock content %}
